<!DOCTYPE html>
<html>
<head>
  <title>Binary Tree Visualization</title>
  <style>
    /* Add your custom CSS styles for the tree visualization here */
    body {
      font-family: Arial, sans-serif;
      overflow-x: auto; /* Enable horizontal scrolling */
      white-space: nowrap; /* Prevent line breaks for the nodes */
    }

    .node-container {
      display: inline-block;
      margin: 10px;
    }

    .node {
      display: inline-block;
      border: 1px solid #000;
      padding: 5px 10px;
      margin: 5px;
    }

    .arrow {
      display: inline-block;
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-bottom: 10px solid #000;
      margin-top: -5px;
    }

    .divider {
      width: 20px;
      height: 2px;
      background-color: #000;
      display: inline-block;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <div id="tree" class="node-container"></div>

  <script>
    async function getAndDrawTree() {
      try {
        const response = await fetch('https://income-mining.onrender.com/api/users/getChildNodes', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            "node_id": "64c00b6a849a379cc91b4ab4",
          }),
        });

        if (!response.ok) {
          throw new Error('Network response was not ok');
        }

        const data = await response.json();
        const nodes = data.nodes;

        // The 'nodes' array contains the nodes data received from the server.
        // You can now proceed to draw the binary tree using the 'nodes' array.
        // You can use the createTreeNode function from the previous example.

        // Example code to draw the binary tree:
        const treeContainer = document.getElementById('tree');

        function createTreeNode(node) {
          const nodeElement = document.createElement('div');
          nodeElement.classList.add('node');
          nodeElement.textContent = node.username; // Customize this based on the properties you want to display

          if (node.left_child_id) {
            const leftChildNode = nodes.find(n => n._id === node.left_child_id);
            if (leftChildNode) {
              const leftArrow = document.createElement('div');
              leftArrow.classList.add('arrow');

              const leftChildElement = createTreeNode(leftChildNode);

              nodeElement.appendChild(leftArrow);
              nodeElement.appendChild(leftChildElement);
            }
          }

          if (node.right_child_id) {
            const rightChildNode = nodes.find(n => n._id === node.right_child_id);
            if (rightChildNode) {
              const rightArrow = document.createElement('div');
              rightArrow.classList.add('arrow');

              const rightChildElement = createTreeNode(rightChildNode);

              const divider = document.createElement('div');
              divider.classList.add('divider');

              nodeElement.appendChild(rightArrow);
              nodeElement.appendChild(divider);
              nodeElement.appendChild(rightChildElement);
            }
          }

          return nodeElement;
        }

        if (nodes.length > 0) {
          const rootNode = nodes.find(n => n.parent_id === null);
          if (rootNode) {
            const tree = createTreeNode(rootNode);
            treeContainer.appendChild(tree);
          } else {
            console.error('Root node not found in the nodes array.');
          }
        } else {
          console.error('No nodes data received from the server.');
        }

      } catch (err) {
        console.error('Error:', err.message);
      }
    }

    // Call the function to get and draw the binary tree when the page loads
    window.addEventListener('load', () => {
      getAndDrawTree();
    });
  </script>
</body>
</html>
